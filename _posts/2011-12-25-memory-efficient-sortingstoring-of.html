---
layout: post
title: Memory efficient Sorting/Storing of Integer Arrays:Bitmapping
date: '2011-12-25T00:04:00.000+05:30'
author: Rajeev Sreedharan
tags:
- C/C++
modified_time: '2013-01-22T20:06:07.533+05:30'
blogger_id: tag:blogger.com,1999:blog-2447788814762842787.post-8050508394756719519
blogger_orig_url: http://myfossblog.blogspot.com/2011/12/memory-efficient-sortingstoring-of.html
---

<div style="font-family: &quot;Courier New&quot;,Courier,monospace;">How about creating a number array in C with each element using just one bit of memory?There is no doubt that there are no datatypes in C whose size is 1 bit.Then how?What more,the list gets automatically sorted!</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: large;"><a href="https://gist.github.com/4595074" target="_blank">Click here to see code:Storing array using Bitmapping with BitArray</a><span style="font-size: small;">(simple and short,requires basic knowledge of bit operations)</span></span></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small;"><span style="font-size: large;"><a href="https://gist.github.com/4595067" target="_blank">Click here to see code :Storing array using Bitmapping with BitFields</a></span><span style="font-size: small;">(long and boring,just a test code</span></span><span style="font-size: small;">,using simple logic)</span><br /><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><i><u>Demerits of bitmapping:</u></i></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">1.No repetitions allowed.All redundant entries will be ignored,and just one will remain.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">2.It may result in wastage of memory when the upper limit of list is large while list is small.(For eg,a list with upper_limit=5000 and containing 10 entries will be alloted 626 bytes). So it is recommended only when the number of entries are comparable to the upper_limit.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><i><u>Merits of bitmapping</u></i></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">1.Uses only&nbsp; approximately <span style="color: magenta;">largest_number/8</span> bytes.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">2.The list is automatically sorted,without any sorting procedures.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">The storage technique is based on a concept named bitmapping.Instead of storing the number in the memory,you make use of the index of the array.And in the memory,you store 1 if the index is present in the list else 0.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: large;"><u><i>A short note on Bit Fields</i></u></span></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">Again,How can you store "1" in 1 bit?Well the answer is <a href="http://en.wikipedia.org/wiki/Bit_field" target="_blank">Bitfields</a> .It is a very helpful when there is no need to allot 4 bytes for an integer,and the task may be done with a few bits.For eg a boolean element needs just one bit to store 0 or 1.Likewise,to store numbers from 0 to 3,you just need two bits.In such occasions we may use bit fields.</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">struct bits</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">{</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">//This is just an example.Please read the section below </div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char gender:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">}</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><b><u><i>Memory Padding</i></u></b></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">Another fact to be noted is about memory padding.Even if a structure of size one bit is created,its size would be equal to the size of datatype.For example the above structure would have a size of 1 byte.(refer <a href="http://en.wikipedia.org/wiki/Data_structure_alignment" target="_blank">Data structure alignment</a>).So for efficient use of the bitfelds,use all the bits,For eg</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">struct bits</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">{</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num1:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num2:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num3:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num4:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num5:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num6:1;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num7:1;&nbsp;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; unsigned char num8:1; </div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">}</div><div style="color: blue; font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">The above structure uses only one bit!So you have 8 variables in 1 byte,ie one bit per variable. </div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">To assign a value to a bit sized variable,you will have to use const or #define and create constants.Then they may be treated just like integers.</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">#define TRUE 1</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">const FALSE 0;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">main()</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">{</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp; struct bits eg;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp; eg.num1=TRUE;</div><div style="color: magenta; font-family: &quot;Courier New&quot;,Courier,monospace;">}</div>